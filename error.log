{"level":"error","message":"Erro ao conectar ao MongoDB: Could not connect to any servers in your MongoDB Atlas cluster. One common reason is that you're trying to access the database from an IP that isn't whitelisted. Make sure your current IP address is on your Atlas cluster's IP whitelist: https://www.mongodb.com/docs/atlas/security-whitelist/","reason":{"commonWireVersion":0,"compatible":true,"heartbeatFrequencyMS":10000,"localThresholdMS":15,"logicalSessionTimeoutMinutes":null,"maxElectionId":null,"maxSetVersion":null,"servers":{"wabotdatabank-shard-00-00.ejoy6.mongodb.net:27017":{"$clusterTime":null,"address":"wabotdatabank-shard-00-00.ejoy6.mongodb.net:27017","arbiters":[],"electionId":null,"error":{},"hosts":[],"lastUpdateTime":1712643477,"lastWriteDate":0,"logicalSessionTimeoutMinutes":null,"maxWireVersion":0,"me":null,"minRoundTripTime":0,"minWireVersion":0,"passives":[],"primary":null,"roundTripTime":-1,"setName":null,"setVersion":null,"tags":{},"topologyVersion":null,"type":"Unknown"},"wabotdatabank-shard-00-01.ejoy6.mongodb.net:27017":{"$clusterTime":null,"address":"wabotdatabank-shard-00-01.ejoy6.mongodb.net:27017","arbiters":[],"electionId":null,"error":{},"hosts":[],"lastUpdateTime":1712643586,"lastWriteDate":0,"logicalSessionTimeoutMinutes":null,"maxWireVersion":0,"me":null,"minRoundTripTime":0,"minWireVersion":0,"passives":[],"primary":null,"roundTripTime":-1,"setName":null,"setVersion":null,"tags":{},"topologyVersion":null,"type":"Unknown"},"wabotdatabank-shard-00-02.ejoy6.mongodb.net:27017":{"$clusterTime":null,"address":"wabotdatabank-shard-00-02.ejoy6.mongodb.net:27017","arbiters":[],"electionId":null,"error":{},"hosts":[],"lastUpdateTime":1712643592,"lastWriteDate":0,"logicalSessionTimeoutMinutes":null,"maxWireVersion":0,"me":null,"minRoundTripTime":0,"minWireVersion":0,"passives":[],"primary":null,"roundTripTime":-1,"setName":null,"setVersion":null,"tags":{},"topologyVersion":null,"type":"Unknown"}},"setName":"atlas-van1gi-shard-0","stale":false,"type":"ReplicaSetNoPrimary"},"stack":"MongooseServerSelectionError: Could not connect to any servers in your MongoDB Atlas cluster. One common reason is that you're trying to access the database from an IP that isn't whitelisted. Make sure your current IP address is on your Atlas cluster's IP whitelist: https://www.mongodb.com/docs/atlas/security-whitelist/\n    at _handleConnectionErrors (C:\\Users\\vdi.dell\\wwebjs-bot\\node_modules\\mongoose\\lib\\connection.js:909:11)\n    at NativeConnection.openUri (C:\\Users\\vdi.dell\\wwebjs-bot\\node_modules\\mongoose\\lib\\connection.js:860:11)\n    at async connectToMongoDB (C:\\Users\\vdi.dell\\wwebjs-bot\\main.js:31:9)\n    at async main (C:\\Users\\vdi.dell\\wwebjs-bot\\main.js:90:19)"}
{"code":8000,"codeName":"AtlasError","connectionGeneration":0,"errorResponse":{"code":8000,"codeName":"AtlasError","errmsg":"bad auth : authentication failed","ok":0},"level":"error","message":"Erro ao conectar ao MongoDB: bad auth : authentication failed","ok":0,"stack":"MongoServerError: bad auth : authentication failed\n    at Connection.sendCommand (C:\\Users\\vdi.dell\\wwebjs-bot\\node_modules\\mongodb\\lib\\cmap\\connection.js:289:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Connection.command (C:\\Users\\vdi.dell\\wwebjs-bot\\node_modules\\mongodb\\lib\\cmap\\connection.js:312:26)\n    at async continueScramConversation (C:\\Users\\vdi.dell\\wwebjs-bot\\node_modules\\mongodb\\lib\\cmap\\auth\\scram.js:131:15)\n    at async executeScram (C:\\Users\\vdi.dell\\wwebjs-bot\\node_modules\\mongodb\\lib\\cmap\\auth\\scram.js:80:5)\n    at async ScramSHA1.auth (C:\\Users\\vdi.dell\\wwebjs-bot\\node_modules\\mongodb\\lib\\cmap\\auth\\scram.js:39:16)\n    at async performInitialHandshake (C:\\Users\\vdi.dell\\wwebjs-bot\\node_modules\\mongodb\\lib\\cmap\\connect.js:104:13)\n    at async connect (C:\\Users\\vdi.dell\\wwebjs-bot\\node_modules\\mongodb\\lib\\cmap\\connect.js:24:9)"}
{"level":"error","message":"Erro na execução principal: messageHandlers.attachMessageHandlers is not a function","stack":"TypeError: messageHandlers.attachMessageHandlers is not a function\n    at initializeWhatsAppClient (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:59:21)\n    at main (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:30:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}
{"level":"error","message":"Erro na execução principal: message is not defined","stack":"ReferenceError: message is not defined\n    at initializeWhatsAppClient (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:59:51)\n    at main (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:30:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}
{"level":"error","message":"Erro na execução principal: message is not defined","stack":"ReferenceError: message is not defined\n    at Object.attachMessageHandlers (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:55:59)\n    at initializeWhatsAppClient (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:59:21)\n    at main (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:30:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}
{"code":"ERR_INVALID_ARG_TYPE","level":"error","message":"Erro na execução principal: The \"listener\" argument must be of type function. Received an instance of Promise","stack":"TypeError [ERR_INVALID_ARG_TYPE]: The \"listener\" argument must be of type function. Received an instance of Promise\n    at checkListener (node:events:277:3)\n    at _addListener (node:events:553:3)\n    at Client.addListener (node:events:612:10)\n    at Object.attachMessageHandlers (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:55:10)\n    at initializeWhatsAppClient (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:59:21)\n    at main (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:30:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}
{"level":"error","message":"Erro ao processar mensagem: Cannot read properties of undefined (reading 'getChat')","stack":"TypeError: Cannot read properties of undefined (reading 'getChat')\n    at get_message_info (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:8:30)\n    at Object.handleMessageCreate (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:60:32)\n    at initializeWhatsAppClient (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:59:21)\n    at main (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:30:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2024-10-04T09:12:35.950Z"}
{"level":"error","message":"Erro ao processar mensagem: Cannot read properties of undefined (reading 'getChat')","stack":"TypeError: Cannot read properties of undefined (reading 'getChat')\n    at get_message_info (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:9:30)\n    at Object.handleMessageCreate (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:61:32)\n    at initializeWhatsAppClient (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:59:21)\n    at main (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:30:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2024-10-04T09:25:40.436Z"}
{"level":"error","message":"Erro ao processar mensagem: Cannot read properties of undefined (reading 'getChat')","stack":"TypeError: Cannot read properties of undefined (reading 'getChat')\n    at get_message_info (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:9:30)\n    at Object.handleMessageCreate (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:61:32)\n    at initializeWhatsAppClient (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:59:21)\n    at main (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\main.js:30:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2024-10-04T09:26:24.910Z"}
{"level":"error","message":"Erro ao processar mensagem: Cannot read properties of undefined (reading 'getChat')","stack":"TypeError: Cannot read properties of undefined (reading 'getChat')\n    at get_message_info (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:9:30)\n    at Client.handleMessageCreate (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:61:32)\n    at Client.emit (node:events:520:28)\n    at C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\src\\Client.js:430:22\n    at CDPPage._CDPPage_onBindingCalled (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\Page.js:2462:30)\n    at C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\Page.js:160:100\n    at C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\third_party\\mitt\\index.js:3:232\n    at Array.map (<anonymous>)\n    at Object.emit (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\third_party\\mitt\\index.js:3:216)\n    at CDPSessionImpl.emit (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\EventEmitter.js:87:22)\n    at CDPSessionImpl._onMessage (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\Connection.js:350:18)\n    at Connection.onMessage (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\Connection.js:156:25)\n    at WebSocket.<anonymous> (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\NodeWebSocketTransport.js:45:32)\n    at WebSocket.onMessage (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\ws\\lib\\event-target.js:199:18)\n    at WebSocket.emit (node:events:520:28)\n    at Receiver.receiverOnMessage (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\ws\\lib\\websocket.js:1178:20)","timestamp":"2024-10-04T09:32:12.838Z"}
{"level":"error","message":"Erro ao processar mensagem: client is not defined","stack":"ReferenceError: client is not defined\n    at get_message_info (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:14:52)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Client.handleMessageCreate (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:61:26)","timestamp":"2024-10-04T09:34:25.841Z"}
{"level":"error","message":"Erro ao processar mensagem: Converting circular structure to JSON\n    --> starting at object with constructor 'Mongoose'\n    |     property 'connections' -> object with constructor 'Array'\n    |     index 0 -> object with constructor 'NativeConnection'\n    --- property 'base' closes the circle","stack":"TypeError: Converting circular structure to JSON\n    --> starting at object with constructor 'Mongoose'\n    |     property 'connections' -> object with constructor 'Array'\n    |     index 0 -> object with constructor 'NativeConnection'\n    --- property 'base' closes the circle\n    at JSON.stringify (<anonymous>)\n    at get_message_info (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:7:46)\n    at handleMessageCreate (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:61:32)\n    at Client.emit (node:events:520:28)\n    at C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\src\\Client.js:430:22\n    at CDPPage._CDPPage_onBindingCalled (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\Page.js:2462:30)\n    at C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\Page.js:160:100\n    at C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\third_party\\mitt\\index.js:3:232\n    at Array.map (<anonymous>)\n    at Object.emit (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\third_party\\mitt\\index.js:3:216)\n    at CDPSessionImpl.emit (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\EventEmitter.js:87:22)\n    at CDPSessionImpl._onMessage (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\Connection.js:350:18)\n    at Connection.onMessage (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\Connection.js:156:25)\n    at WebSocket.<anonymous> (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\puppeteer-core\\lib\\cjs\\puppeteer\\common\\NodeWebSocketTransport.js:45:32)\n    at WebSocket.onMessage (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\node_modules\\whatsapp-web.js\\node_modules\\ws\\lib\\event-target.js:199:18)\n    at WebSocket.emit (node:events:520:28)","timestamp":"2024-10-04T09:40:04.701Z"}
{"level":"error","message":"Erro ao processar mensagem: Cannot read properties of undefined (reading 'info')","stack":"TypeError: Cannot read properties of undefined (reading 'info')\n    at get_message_info (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:15:59)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Client.handleMessageCreate (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:62:26)","timestamp":"2024-10-04T09:45:26.002Z"}
{"level":"error","message":"Erro ao processar mensagem: Cannot read properties of undefined (reading 'body')","stack":"TypeError: Cannot read properties of undefined (reading 'body')\n    at log_message_info (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:33:38)\n    at Client.handleMessageCreate (C:\\Users\\gabriel.araujo\\Documents\\GitHub\\Lead-Web-Bot\\messageHandlers.js:63:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2024-10-04T09:48:10.529Z"}
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
undefined
